(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{1516:function(t,e,n){var content=n(1666);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(14).default)("87406466",content,!0,{sourceMap:!1})},1665:function(t,e,n){"use strict";n(1516)},1666:function(t,e,n){var o=n(13)((function(i){return i[1]}));o.push([t.i,".a-default-list-responsive[data-v-2590909d]{border:1px solid var(--v-neutrals-40-base)!important;border-radius:3px;box-shadow:none!important;margin:16px 24px!important}.a-default-list-responsive[data-v-2590909d]  .a-default-list__header{display:block;max-width:100%!important;padding:4px 24px!important}.a-default-list-responsive[data-v-2590909d]  .a-default-list__header>div:first-child{max-width:100%!important}.a-default-list-responsive[data-v-2590909d]  .a-default-list__header>div:first-child h1{color:var(--v-neutrals-800-base);font-size:1rem;font-weight:700;line-height:1.571rem}.a-default-list-responsive .slot-content[data-v-2590909d]{padding:24px}@media only screen and (min-width:600px){.a-default-list-responsive[data-v-2590909d]{box-shadow:0 1px 3px 0 rgba(27,39,49,.161)!important}.a-default-list-responsive[data-v-2590909d]  .a-default-list__header{padding:20px 0!important}.a-default-list-responsive[data-v-2590909d]  .a-default-list__header>div:first-child{align-items:center}.a-default-list-responsive[data-v-2590909d]  .a-default-list__header>div:first-child h1{font-size:1.286rem;line-height:1.571rem}}footer[data-v-2590909d]{bottom:0;box-shadow:0 -4px 4px 0 rgba(0,0,0,.04);height:80px;position:fixed}",""]),o.locals={},t.exports=o},2047:function(t,e,n){"use strict";n.r(e);n(9),n(8),n(10),n(11),n(7),n(6);var o=n(12),r=n(1),c=(n(26),n(55),n(2),n(49),n(38),n(1224)),l=n(1291),d=n(1640),h=n(292),m=n(1216),f=n(20);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function _(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C={mixins:[n(207).a],middleware:["_core/authenticated","attempts"],layout:"app/index",head:function(){return{title:this.$t("questionCollection.instructions.title")}},components:{Container:l.a,HeaderQC:h.a,ProctoringForm:d.a,vRuntimeShellWrapper:m.a,ADefaultListResponsive:c.a},data:function(){return{loading:!1,showProctoringForm:!1,showSuccessDialog:!1,socketConnection:{connected:!1},socketStatus:{},accepted:!1,routeParams:{},externalSource:null}},computed:_(_(_({},Object(f.mapState)({questionCollection:function(t){return t.app.questionCollection},params:function(t){return t.app.params},userId:function(t){return t._core.user.id},userUuid:function(t){return t._core.user.uuid},currrentAttemptExternalId:function(t){return t.id}})),Object(f.mapGetters)({isProctoringEnabled:"app/isProctoringEnabled",isStarted:"app/isStarted",isImpersonated:"_core/auth/isImpersonated",currentTarget:"app/currentTarget",questionCollections:"app/getQuestionCollections",getQuestionCollection:"app/getQuestionCollection",__isFinished:"app/__isFinished",isExternalAuthMode:"app/isExternalAuthMode",isInsideIframe:"app/isInsideIframe",isQuestionCollectionSourceAvalia:"app/isQuestionCollectionSourceAvalia",__isProctoringAuthenticated:"proctoring/__isProctoringAuthenticated",__getProctoringInstructionsRequiredParams:"proctoring/__getProctoringInstructionsRequiredParams"})),{},{reconnectionAttempts:function(){return 10},isReconnecting:function(){return!1},hasFeedback:function(){return this.questionCollection.isFeedback},isFinished:function(){return this.questionCollection.finished},showFeedbackButton:function(){return this.isFinished&&this.hasFeedback},collectionInstructions:function(){return this.questionCollection.instructions}}),mounted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,data,c,l,d,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.routeParams=t.getRouteParams(),e.prev=1,t.__isProctoringAuthenticated&&(console.log("isAuthenticated"),t.routeParams=Object.assign({},t.routeParams,t.__getProctoringInstructionsRequiredParams)),!(void 0===t.routeParams.idRespondentQuestionCollection)){e.next=6;break}throw"invalid-id-respondent-question-collection";case 6:return o=t.routeParams.externalSource||t.routeParams.questionCollectionExternalSource,t.setQuestionCollectionExternalSource(o),t.SET_QUESTION_COLLECTION_EXTERNAL_ID(t.routeParams.questionCollectionExternalId),e.next=11,t.getQuestionCollectionInstructions(t.routeParams.idRespondentQuestionCollection);case 11:if(r=e.sent,data=r.data,r.success){e.next=16;break}throw new data.error.code;case 16:if(c=data.currentAttempt,l=data.totalAttempts,data.attempts,d=data.externalId,data.isActive){e.next=19;break}throw"question-collection-inactive";case 19:return e.next=21,t.SET_ACTIVITY_EXTERNAL_ID(c.externalId);case 21:if(t.__isProctoringAuthenticated){e.next=24;break}return e.next=24,t.__setProctoringInstructionsRequiredParams({questionCollectionExternalId:t.routeParams.questionCollectionExternalId,questionCollectionExternalSource:o,activityExternalId:data.activityExternalId,idRespondentQuestionCollection:t.routeParams.idRespondentQuestionCollection});case 24:if(h="avalia"===o,c.attempt>l||c.attempt===l&&c.rqcStarted&&c.rqcFinished?(t.SET_QUESTION_COLLECTION_START_INFORMATION({rqcStarted:!0,rqcFinished:!0,isFeedback:h?data.params.isFeedback:c.showResult}),t.redirectIfIsFinished({questionCollectionExternalId:d,questionCollectionExternalSource:t.routeParams.externalSource,activityRespondentExternalId:c.externalId,showResult:c.showResult})):c.rqcStarted&&c.rqcFinished?t.SET_QUESTION_COLLECTION_START_INFORMATION({rqcStarted:!1,rqcFinished:!1,isFeedback:h?data.params.isFeedback:c.showResult}):t.SET_QUESTION_COLLECTION_START_INFORMATION({rqcStarted:c.rqcStarted,rqcFinished:c.rqcFinished,isFeedback:h?data.params.isFeedback:c.showResult}),null===(n=t.routeParams)||void 0===n||!n.institutionCode){e.next=29;break}return e.next=29,t.__updateInstitutionParameter({institutionCode:t.routeParams.institutionCode});case 29:t.socketConnection=t.$nuxtSocket({persist:!0,reconnection:!0,reconnectionAttempts:t.reconnectionAttempts,reconnectionDelayMax:2e4}),t.socketConnection.on("disconnect",(function(e){"io server disconnect"===e&&t.socketConnection.connect()})),t.socketConnection.on("connect",(function(){t.emitAuthenticate()})),t.__isProctoringAuthenticated&&(t.accepted=!0,t.startProctoring(),t.initApplication()),e.next=40;break;case 35:e.prev=35,e.t0=e.catch(1),t.$sentry.captureException(e.t0),t.__resetProctoring(),"question-collection-inactive"===e.t0?t.$router.push({name:"inactive-question-collection",params:{validAccess:!0}}):t.isExternalAuthMode?t.$router.push("/public-error/".concat(e.t0)):t.$router.push("/question-collections");case 40:case"end":return e.stop()}}),e,null,[[1,35]])})))()},methods:_(_(_({},Object(f.mapActions)({startApplication:"app/startApplication",closeApplication:"app/closeApplication",getQuestionCollectionInstructions:"app/getQuestionCollectionInstructions",setQuestionCollectionExternalSource:"app/setQuestionCollectionExternalSource",setQuestionCollection:"app/setQuestionCollection",setQuestionCollections:"app/setQuestionCollections",__updateInstitutionParameter:"institutionParameter/__updateInstitutionParameter",__setProctoringInstructionsRequiredParams:"proctoring/__setProctoringInstructionsRequiredParams",__resetProctoring:"proctoring/__resetProctoring"})),Object(f.mapMutations)({SET_AVAILABLE_FEEDBACK:"app/SET_AVAILABLE_FEEDBACK",SET_QUESTION_COLLECTION_EXTERNAL_ID:"questionCollection/SET_EXTERNAL_ID",SET_ACTIVITY_EXTERNAL_ID:"activity/SET_EXTERNAL_ID",SET_QUESTION_COLLECTION_START_INFORMATION:"app/SET_QUESTION_COLLECTION_START_INFORMATION"})),{},{showSuccessDialogAndStart:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t.showSuccessDialog=!0,t.loading=!0,setTimeout(Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.startApplication();case 2:case"end":return e.stop()}}),e)}))),2e3)}catch(e){t.$sentry.captureException("Error on showSuccessDialogAndStart ".concat(e)),t.showSuccessDialog=!1,t.loading=!1}case 1:case"end":return e.stop()}}),e)})))()},initApplication:function(){var t=this;!this.isProctoringEnabled||this.__isProctoringAuthenticated?this.socketConnection.connected?this.socketConnection.emit("CreateUser","".concat(this.userId,"_").concat(this.userUuid),(function(e){"S"===e.user.clientAction?t.$toast.error(t.$t("questionCollection.type.assessment.instructions.twoTabsMessage")):t.showSuccessDialogAndStart()})):this.showSuccessDialogAndStart():this.showProctoringForm=!0},emitAuthenticate:function(){this.socketConnection.emit("authenticate",{token:"3Jk3BJ]Ou8kj9RT7Kelri5F7tBJXZ7EWYJpqkuMNfxb2XDOtrxHqtZVXbtgnruWGsjxiZvcUhecWUqIp078HlJegPNacs1yqSeaS9nrHaxnKOV5BBtSXbCxnaSU84Ujt4HWklAh3SjCbkPndHiTsX5NTUgnrUTCObVTzUZ8mNFFvo7Aht59HG3slDwpA4QQAApxSKzbdIGVZ3W6XZ7qIu3TmWQ2EpVaY6oL1Gsb83MRShmOgkE5VPebO2i1PPMbtjX7ADT"})},openQuestionCollectionView:function(){this.$router.push({name:"app",params:this.routeParams})},logout:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return sessionStorage.removeItem("id_rqc"),sessionStorage.setItem("isExitingApplication",!0),e.next=4,t.$store.dispatch("_core/auth/actionSignOut");case 4:case"end":return e.stop()}}),e)})))()},getAttemptWithResults:function(t){return t.find((function(t){return t.showResult&&t.rqcFinished}))},redirectIfIsFinished:function(t){t.showResult?this.$router.push({name:"results-respondent-questionCollectionExternalId-activityRespondentExternalId",params:t}):this.$router.push({name:"finish",params:t})},getRouteParams:function(){return _(_({},this.$route.query),this.$route.params)},getFirst:function(){var t=arguments.length>1?arguments[1]:void 0,e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find((function(source){return source&&t in source}));return(null==e?void 0:e[t])||null},startProctoring:function(){console.log("start proctoring"),window.postMessage({action:"proctorStart"})},stopProctoring:function(){console.log("stop proctoring"),window.postMessage({action:"proctorStop"})},handleTermsAccepted:function(){this.accepted=!this.accepted}})},x=C,w=(n(1665),n(25)),I=n(28),S=n.n(I),A=n(463),E=n(280),k=n(431),P=n(83),T=n(240),O=n(186),component=Object(w.a)(x,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"full-width",staticStyle:{"min-height":"calc(100vh - 92px)"}},[n("a-default-list-responsive",{staticClass:"full-height mb-14",attrs:{"data-test-id":"instructions-default-list",title:t.$t("questionCollection.instructions.title"),loading:t.loading||!t.collectionInstructions,"disable-fixed-footer":t.$vuetify.breakpoint.smAndUp,"container-grow":""}},[n("template",{slot:"headers"},[n("HeaderQC",{attrs:{subheaders:t.filteredHeader(t.questionCollection.header,t.questionCollection.isGlobalized),loading:t.loading,inline:"",full:"",padding:""}})],1),t._v(" "),n("template",{slot:"content"},[t.showProctoringForm?t._e():n("div",{staticClass:"full-height d-flex flex-column justify-space-between",attrs:{transition:"fade-transition"}},[n("v-runtime-shell-wrapper",{attrs:{ignore:t.isQuestionCollectionSourceAvalia,html:t.collectionInstructions}}),t._v(" "),n("div",[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.isImpersonated&&!t.isFinished,expression:"!isImpersonated && !isFinished"}]},[n("a-checkbox",{staticClass:"mb-4",attrs:{dataTestId:"accepted-instructions-checkbox","aria-checked":t.accepted,tabindex:"0",role:"checkbox"},on:{keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"space",32,e.key,[" ","Spacebar"]))return null;e.preventDefault()}},model:{value:t.accepted,callback:function(e){t.accepted=e},expression:"accepted"}},[n("template",{slot:"label"},[n("button",{staticClass:"text-800",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleTermsAccepted.apply(null,arguments)}}},[t._v("\n                  "+t._s(t.$t("questionCollection.instructions.accept"))+"\n                ")])])],2),t._v(" "),t.$vuetify.breakpoint.smAndUp?n("a-btn",{attrs:{"data-test-id":"start-application-button",variant:"default","aria-label":t.isProctoringEnabled?t.$t("questionCollection.type.assessment.instructions.continue"):t.$t("questionCollection.type.assessment.instructions.start"),disabled:!t.accepted},on:{click:t.initApplication}},[t._v("\n              "+t._s(t.isProctoringEnabled?t.$t("questionCollection.type.assessment.instructions.continue"):t.$t("questionCollection.type.assessment.instructions.start"))+"\n            ")]):t._e()],1),t._v(" "),t.$vuetify.breakpoint.smAndUp?n("v-btn",{directives:[{name:"show",rawName:"v-show",value:t.isImpersonated&&!t.showFeedbackButton,expression:"isImpersonated && !showFeedbackButton"}],staticClass:"primary text-decoration-none",attrs:{large:"",depressed:""},on:{click:t.openQuestionCollectionView}},[t._v("\n            "+t._s(t.$t("questionCollection.type.assessment.view"))+"\n            "),n("v-icon",{attrs:{right:""}},[t._v("\n              mdi-chevron-right\n            ")])],1):t._e(),t._v(" "),n("v-btn",{directives:[{name:"show",rawName:"v-show",value:t.showFeedbackButton,expression:"showFeedbackButton"}],attrs:{color:"info",large:"",depressed:""},on:{click:function(e){return t.openFeedbackRoute()}}},[t._v("\n            "+t._s(t.$t("questionCollection.feedback.actionBtnTitle"))+"\n            "),n("v-icon",{attrs:{right:""}},[t._v("\n              mdi-chevron-right\n            ")])],1)],1)],1),t._v(" "),t.showProctoringForm?n("proctoring-form",{on:{finished:t.showSuccessDialogAndStart}}):t._e(),t._v(" "),t.isReconnecting?n("v-alert",{attrs:{type:"error",icon:"mdi-alert-octagon-outline",outlined:""}},[t._v("\n        "+t._s(t.$t("questionCollection.instructions.reconnecting",{attempt:t.socketStatus.reconnectAttempt||"1"}))+"\n      ")]):t._e()],1),t._v(" "),n("template",{slot:"footer"},[n("div",{staticClass:"d-flex gap-2 align-center flex-grow-1 justify-center"},[n("a-btn",{attrs:{"data-test-id":"start-application-button",variant:"default","aria-label":t.isProctoringEnabled?t.$t("questionCollection.type.assessment.instructions.continue"):t.$t("questionCollection.type.assessment.instructions.start"),disabled:!t.accepted},on:{click:t.initApplication}},[t._v("\n          "+t._s(t.isProctoringEnabled?t.$t("questionCollection.type.assessment.instructions.continue"):t.$t("questionCollection.type.assessment.instructions.start"))+"\n        ")]),t._v(" "),n("v-btn",{directives:[{name:"show",rawName:"v-show",value:t.showFeedbackButton,expression:"showFeedbackButton"}],attrs:{color:"info",large:"",depressed:""},on:{click:function(e){return t.openFeedbackRoute()}}},[t._v("\n          "+t._s(t.$t("questionCollection.feedback.actionBtnTitle"))+"\n          "),n("v-icon",{attrs:{right:""}},[t._v("\n            mdi-chevron-right\n          ")])],1)],1)])],2),t._v(" "),n("v-dialog",{attrs:{transition:"dialog-top-transition","max-width":"400","content-class":"rounded-xl",persistent:""},model:{value:t.showSuccessDialog,callback:function(e){t.showSuccessDialog=e},expression:"showSuccessDialog"}},[n("v-card",{staticClass:"success-dialog-container"},[n("v-card-text",{staticClass:"text-center pa-5"},[n("v-icon",{staticClass:"success-dialog-icon pa-2",attrs:{transition:"fade-transition","aria-hidden":"true",color:"green darken-2"}},[t._v("\n          mdi-checkbox-marked-circle-outline\n        ")]),t._v(" "),n("div",[n("h3",{staticClass:"my-5"},[t._v("\n            "+t._s(t.$t("questionCollection.realization.startingAssessment")+"...")+"\n          ")])])],1)],1)],1)],1)}),[],!1,null,"2590909d",null);e.default=component.exports;S()(component,{VAlert:A.a,VBtn:E.a,VCard:k.a,VCardText:P.d,VDialog:T.a,VIcon:O.a})}}]);